#Глава 1 - Создание Dockerfile
Первое с чем нужно разобраться, это что такое docker file, container и image. 

Ранее мы написали очень простое веб-приложение, но хотим, чтобы это приложение запускал docker. Но как docker узнает, 
что оно работает в python и необходимо установить две библиотеки, а ещё особый запуск из-за расположения файла? 
За все эти вопросы - что, где, как - отвечает Dockerfile. Это набор инструкций и команд, который говорит docker 
как нужно запускать приложение, что установить и как подготовить виртуальное окружение для приложения. Практически 
всё то, что вы делали в терминале, необходимо записать в Dockerfile.

Docker image - это результат работы Dockerfile. Когда вы написали необходимые команды для Dockerfile, то выполнение 
этого файла создаёт в docker образ (image) будущего приложения. Но это только образ, это ещё не запущенное приложение.

Docker container - это запущенное приложение. Причём образ (image) один, а контейнеров (container) от этого 
образа может быть несколько. Именно с запущенным контейнером мы сможем общаться по `localhost`, например. При этом 
следует отметить, что у каждого контейнера будет свой порт, и при обращении к конкретному контейнеру это 
следует учитывать. 

Что ж, приступим к созданию Dockerfile. Для начала создайте файл без разрешения рядом `webapp.py` и 
назовите его `Dockerfile`. Структура проекта должна выглядеть так:
```text
web / 
    Dockerfile
    webapp.py
```

Так как мы только начинаем изучать docker, то не будем усложнять задачу и воспользуемся готовыми образами. 
Для нашей задачи понадобится готовый образ python 3.9, поэтому первой строчкой пишем:
```dockerfile
FROM python:3.9
```

Это означает, что необходимо взять базовый образ python 3.9. Подробнее про другие версии python можно 
посмотреть [по этой ссылке](https://hub.docker.com/_/python/).

Обратите внимание, что версия `3` или `latest` каждый раз будет перемещаться. В нашем случае я зафиксировала, 
что нам нужен python `3.9`, но на момент написания этой главы была доступна версия `3.9.7`. Это означает, что если выйдет 
какое-то обновление, например, `3.9.8`, то будет установленно именно оно, а не `3.9.7`.

Далее добавим рабочую директорию:
```dockerfile
WORKDIR /usr/src/app
```

Далее давайте создадим в проекте файл с библиотеками, которые нам надо установить. Создайте в папке `web`
файл `requirements.txt` и запишите там `fastapi` и `uvicorn`:

```text
fastapi~=0.68.1
uvicorn~=0.15.0
```

И пропишем команды в Dockerfile, которые установят эти библиотеки из `requirements.txt`:

```dockerfile
COPY requirements.txt ./
RUN pip install --no-cache-dir -r requirements.txt
```

Далее скопируем файлы из текущей папки в docker образ:

```dockerfile
COPY . .
```

Т.е. будет скопированно содержимое папки `web` в папку образа `/usr/src/app`.

И теперь необходимо написать команду запуска проекта, когда будет запущен docker контейнер:

```dockerfile
CMD ["uvicorn", "webapp:app", "--host", "0.0.0.0", "--port", "8000"]
```

Далее необходимо открыть терминал так, чтобы текущее положение было:

```text
path_to_project/hello_docker_1_level/web$
```

И в консоли написать две команды: 
```commandline
docker build -t webappimg .
docker container run -i -t -p 8005:8000 --name webappcont --rm  webappimg 
```

и после успешного запуска в терминале должно быть что-то такое:

```text
INFO:     Started server process [1]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
```

И перейдите по ссылке:
```text
http://localhost:8005/
```